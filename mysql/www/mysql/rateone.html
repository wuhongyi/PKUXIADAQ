<!doctype html> 
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html" />
    <meta http-equiv="charset" content="utf-8">
    <!-- <meta http-equiv="refresh" content="5" /> -->
    <meta name="author" content="Hongyi Wu">
    <meta name="description" content="Pixie-16 MZ Trigger IO">
    <meta name="keywords" content="XIA, Pixie16, DT5495">
    <meta name="generator" content="emacs">
    <meta name="revised" content="Hongyi Wu, 05/27/19">

    <script type="text/javascript" src="../static/js/plotly-latest.min.js"></script>
    <script type="text/javascript" src="../static/js/jquery-3.4.1.min.js"></script>
    <link style="text/css" rel="stylesheet" href="../static/css/bootstrap.css">  
    <!--导入基本样式的压缩-->
    <link style="text/css" rel="stylesheet" href="../static/css/bootstrap.min.css">
    <!--导入主题样式  注意：顺序 不可变-->
    <link style="text/css" rel="stylesheet" href="../static/css/bootstrap-theme.css">


    <style type="text/css">
      div {
    	  margin: auto;/*居中设置*/
    	  background-color: #FFFFFF;
    	  /* font-size: 22px; */
    	  /* font-weight: bold; */
    	  /* color: red; */
      }
    </style>

 
    
    <title>  GDDAQ Online  </title>
  </head>
  
  <body style="margin: 0px auto; width: 1200px;">
    <!-- header -->

    <header style="margin: auto; height: 100px;">
      <div class="pkulogo" style="width: 100px; float: left;">
	<img src=pkulogo100.jpg  border=0>
      </div>
      <div class="" style="width: 1000px; text-align: center; float: left;">
	<h1>GDDAQ web Online</h1>
	<p>Thank you for using GDDAQ</p>
      </div>
      <div class="whylogo" style="width: 100px; float: left;">
	<img src=why.jpg  border=0>
      </div>
    </header>


    <!-- nav -->
    <nav style="font-size: 22px;">
	<ul class="nav nav-tabs">
	  <li><a href="index.html" data-toggle="tab">Main</a></li>
	  <li><a href="trigger.html" data-toggle="tab">Trigger</a></li>
	  <li class="active"><a href="rateone.html" data-toggle="tab">RateOne</a></li>
	  <li><a href="rateday.html" data-toggle="tab">RateDay</a></li>
	  <li><a href="status.html" data-toggle="tab">Status</a></li>
	  <li><a href="log.html" data-toggle="tab">Log</a></li>
	  <li><a href="support.html" data-toggle="tab">Support</a></li>
	</ul>
    </nav>
    
    <!-- section -->
    <div class="content" style="width: 1200px;">

      <div id="" class="" style="width: 1200px; vertical-align: middle; display: table-cell; float: left;">
	<h2 style=" margin-top:15px; font-size:20px; font-weight:normal; border-bottom:1px solid #ff9040"> One Channel Monitor </h2>
	
	<P> Choose a mod and a channel. </P>
	<p>
	  <label for="rateonecrate">Crate:</label> <select class="selectpicker" id="rateonecrate" value="0">  <option value="0">0</option> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> <option value="5">5</option> <option value="6">6</option> <option value="7">7</option> </select>
	  <label for="rateonemod">Mod:</label> <select class="selectpicker" id="rateonemod" value="0"> <option value="0">0</option> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> <option value="5">5</option> <option value="6">6</option> <option value="7">7</option> <option value="8">8</option> <option value="9">9</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option> </select>
	  <label for="rateonech">Ch:</label> <select class="selectpicker" id="rateonech" value="0"> <option value="0">0</option> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> <option value="5">5</option> <option value="6">6</option> <option value="7">7</option> <option value="8">8</option> <option value="9">9</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option> <option value="13">13</option> <option value="14">14</option> <option value="15">15</option> </select>
	  <label for="rateonerun">Mode:</label> <select class="selectpicker" id="rateonemode" value="0"> <option value="0">Input Rate</option> <option value="1">Output Rate</option> </select>
	  <label for="rateonerun"> Run: </label><input type="text" size="8" id="rateonerun" value="0">
	  <input id="updaterateone" type="button" class="btn btn-primary btn-sm" value="Update">
	</p>
	<p></p>
	<p></p>
	<p></p>
      </div>

      
      <div id="rateonehis" class="" style="width: 1200px; vertical-align: middle; display: table-cell;">

      </div>
      
    </div>

    <!-- footer -->
    <footer style="font-weight: bold; text-align: center">
      <p>Copyright @ Hongyi Wu &nbsp;&nbsp;&nbsp;&nbsp;  Contact information: <a href="mailto:wuhongyi@qq.com"> wuhongyi@qq.com</a></p>
    </footer>
  </body>

  <script>
    $(function(){

	<!-- $("#readtimediffch").click(function(){// function for  read settings button -->
	<!--     $.get("cgireadtimediffch.cgi", function (data) { -->
	<!-- 	// alert("Data:  " + data); -->
	<!-- 	var dataarray = data.split(',');// "split" data string at commas -->
	<!-- 	//alert("Data[0]:  " + dataarray[0]); -->
	<!-- 	$("#timediffcha").val(dataarray[0]); -->
	<!-- 	$("#timediffchb").val(dataarray[1]);     -->
	<!--     });  // end get -->
	<!-- });		  // end button click read  settings -->


	<!-- $("#writetimediffch").click(function(){		// function for Initialize button -->
	<!--     $.get("cgiwritetimediffch.cgi",{TIMEDIFF:"timediff",  -->
	<!-- 					     v0:$("#timediffcha").val(), -->
	<!-- 					     v1:$("#timediffchb").val() -->
	<!-- 					    }, function (data) { -->
	<!-- 						alert(data); -->
	<!-- 					    })  		// end get -->
	<!-- });		   // end button click refresh  -->

	
	<!-- $("#cleartimediff").click(function(){		// function for Initialize button -->
	<!--     $.get("cgicleartimediff.cgi", function (data) { -->
	<!-- 	alert(data);	     -->
	<!--     })  		// end get -->
	<!-- });		   // end button click refresh       -->



	$("#updaterateone").click(function(){// function for  read settings button
	    $.get("/cgi-bin/rateone.cgi",{READDATA:"cratemodch",v0:$("#rateonecrate").val(),v1:$("#rateonemod").val(),v2:$("#rateonech").val(),v3:$("#rateonemode").val(),v4:$("#rateonerun").val() }, function (data) { //jQuery get function executes cgireadsettings on Pixie-Net -> return data is list of analog settings
		//alert("Data:  " + data);
		var dataarray = data.split(',');  // "split" data string at commas
	//alert("Data: "+dataarray[0]+" "+dataarray[1]);
	
	if(dataarray[0]==0)
        {
	TESTER = document.getElementById('rateonehis');

	var x = [], y = [];

	for(var i = 1; i <= dataarray[1]; i += 1) { x.push(dataarray[2*i]);  y.push(dataarray[2*i+1]);  }
			    Plotly.newPlot(TESTER, [{
			    x: x,
			    y: y,
			    mode: 'markers'
			    }], {
			    margin: {t: 2},
			    xaxis:{
			    title:"Timestamp",
			    titlefont: {color:'black', size:22},
			    tickfont: {color:'black', size:20},
			    autorange:true,
			    },
			    yaxis:{
			    title: "Counts Rate /s",
			    titlefont: {color:'black', size:22},
			    tickfont: {color:'black', size:20},
			    <!-- range: [0,20000] -->
			    },
			    });
			    
			    }
			    else if(dataarray[0]==1)
			    {
			    alert("Crate num error.");
			    }
			    else if(dataarray[0]==2)
			    {
			    alert("Mod num error.");
			    }
			    else if(dataarray[0]==3)
			    {
			    alert("Ch num error.");
			    }
			    else if(dataarray[0]==4)
			    {
			    alert("Run num error.");
			    }
		
	    });  // end get
	});

	
	
	
    });
    


  </script>
  
</html>
