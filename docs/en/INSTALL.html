

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Installation of Software &mdash; GDDAQ beta 文档</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="MYSQL" href="MYSQL.html" />
    <link rel="prev" title="Introduction" href="README.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GDDAQ
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation of Software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-steps-for-installation">The steps for Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#instruction-for-use">Instruction for use</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-installation-errors">Common installation errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#teamviewer">TeamViewer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MYSQL.html">MYSQL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Users Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/README.html">Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/Crate.html">Crate</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/FIRMWARE.html">FIRMWARE</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/Decode.html">Decode</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/GUI.html">GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/NOGUI.html">NOGUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/OnlineStattics.html">Online Stattics</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/MakeEvent.html">MakeEvent</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/FrontPanel.html">Front Panel</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/Logic.html">Logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/MultipleModulesSynchronously.html">Multiple Modules Synchronously</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsersGuide/UpdateCPLD.html">Update CPLD</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Example/README.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example/TOF2TAC.html">TOF measurement in 100M</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example/TimeResolution.html">Time Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example/RecommendedParameters.html">Recommended Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example/InBeamGammaCIAE.html">In Beam Gamma</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmers Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ProgrammersGuide/README.html">Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="ProgrammersGuide/XIAAPI.html">PIXIE-16 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="ProgrammersGuide/PKUCode.html">PKU Code</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GDDAQ</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Installation of Software</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/INSTALL.rst.txt" rel="nofollow"> 查看页面源码</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="installation-of-software">
<h1>Installation of Software<a class="headerlink" href="#installation-of-software" title="永久链接至标题">¶</a></h1>
<p>Installation for this software is requrired by</p>
<ul class="simple">
<li><dl class="simple">
<dt>CERN ROOT 6</dt><dd><ul>
<li><p>GCC &gt;= 4.8</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>FFTW3</p></li>
</ul>
<p>The operating system tested by this program includes CentOS7 / Scientific Linux 7 / Ubuntu18.04</p>
<p><strong>This package uses PLX9054 driver with version 8.23. The operating systems supported by this version of the driver are CentOS 7 / CentOS 8 / Debian 08 / Debian 09 / Debian 10 / Ubuntu 18.04.</strong></p>
<div class="admonition danger">
<p class="admonition-title">危险</p>
<p>Graphical interface programs and non-graphical interface programs cannot run at the same time!</p>
<p>Graphical interface programs and non-graphical interface programs cannot run at the same time!</p>
<p>Graphical interface programs and non-graphical interface programs cannot run at the same time!</p>
</div>
<section id="the-steps-for-installation">
<h2>The steps for Installation<a class="headerlink" href="#the-steps-for-installation" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p>Delete the old version of the PKUXIADAQ folder in your personal directory</p></li>
<li><p>Extract this package into your personal directory ($HOME)</p></li>
<li><p>Set up environment variables</p></li>
<li><p>Compile Plx9054 driver</p></li>
<li><p>Compile pixie16 driver API (this API has been modified by Hongyi Wu, driven by unofficial standards)</p></li>
<li><p>Compile graphical acquisition software</p></li>
<li><p>Compile non-graphical acquisition software</p></li>
<li><p>Compile online monitor program</p></li>
<li><p>Compile data converter program</p></li>
<li><p>Compile event reconstruction program (optional)</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Set up environment variables</span>


<span class="c1"># Add the follwing content into .bashrc file</span>
<span class="nb">export</span> <span class="nv">PLX_SDK_DIR</span><span class="o">=</span><span class="nv">$HOME</span>/PKUXIADAQ/PlxSdk

<span class="c1"># put PKUXIADAQ.tar.gz(or PKUXIADAQ-master.tar.gz) in the personal directory /home, the position ~/</span>

tar -zxvf PKUXIADAQ.tar.gz
or
tar -zxvf PKUXIADAQ-master.tar.gz
mv PKUXIADAQ-master  PKUXIADAQ

<span class="c1"># Acquire PKUXIADAQ directory</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Compile Plx9054 driver</span>

<span class="c1"># Open a new terminal</span>
<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/
<span class="c1">#Delete the undeleted driver that may exist. If there is no such directory, you do not need to execute the command.</span>
rm -rf PlxSdk
tar -xvf PlxSdk823.tar
<span class="nb">cd</span> PlxSdk/PlxApi/
make clean
make
<span class="c1"># If it succeeds,you will see Library &quot;Library/PlxApi.a&quot; built successfully</span>


<span class="nb">cd</span> ../Samples/ApiTest/
make clean
make
<span class="c1">#if it succeeds,you will see Application &quot;App/ApiTest&quot; built successfully</span>


<span class="nb">cd</span> ../../Driver/
./builddriver <span class="m">9054</span>

<span class="c1"># If it succeeds,you will see Driver &quot;Plx9054/Plx9054.ko&quot; built sucessfully</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Compile pixie16</span>

<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/software/
make clean
make

<span class="c1"># As long as no error is reported, the libPixie16App.a libPixie16Sys.a will be generated in the folder</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modify settings parameters</span>
<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/parset/


<span class="c1"># Modify cfgPixie16.txt file。</span>
<span class="c1"># The value after CrateID indicates the chassis number, and the value is allowed to be 0-15. If there is only a chassis, the parameter is set freely (usually the default 0 is used). If multiple chassis are running synchronously, make sure that the number of each chassis is set to a different value.</span>
<span class="c1"># SettingPars Following is the parameter setting file and write the parameter configuration file to be used.</span>
<span class="c1"># ModuleSlot The first value number indicates the number of plugins, and if there are 3 plugins, it is 3. The following numbers are for each plug-in in the slot position of the chassis (the slot position is counted from 2), and there are three plugins followed by 2 3 4 respectively.</span>
<span class="c1">#AutoRunModeTimes The following values are the time for automatic switching in automatic operation mode.</span>
<span class="c1"># Parameter ModuleSampingRate and ModuleBits only take effect in offline mode. When the main interface is initialized in Offline mode, this parameter is read.</span>


<span class="c1"># Modify the Run.config file, the first line in the file is the original data storage path, and the second is the file name.</span>
<span class="c1"># Modify the RunNumber file, the value in this file is the run number of the actual run.</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Compile graphical acquisition software</span>

<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/GUI/
make clean
make
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Compile non-graphical acquisition software</span>

<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/NOGUI/
make clean
make
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Compile online monitor program</span>

<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/OnlineStattics/

make clean
make
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Compile data converter program</span>

<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/Decode/

<span class="c1"># Modify UserDefine.hh according to the instructions in the program.</span>

make clean
make
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Compile event reconstruction program</span>

<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/MakeEvent/

<span class="c1"># Modify UserDefine.hh according to the instructions in the program.</span>

make clean
make
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="instruction-for-use">
<h2>Instruction for use<a class="headerlink" href="#instruction-for-use" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p>Restart the computer after booting the chassis (the computer must be open later than the chassis)</p></li>
<li><p>Load Plx9054 driver under ROOT permission after opening the chassis</p></li>
<li><p>Normal acquisition</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Load Plx9054 driver under ROOT permission</span>


<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/PlxSdk/Bin/

<span class="c1">## CENTOS</span>
su <span class="c1"># input ROOT password</span>
./Plx_load <span class="m">9054</span>
<span class="c1">## Ubuntu</span>
<span class="c1">## The 18th line of the file Plx_load needs to be modified:  export PLX_SDK_DIR=$HOME/PKUXIADAQ/PlxSdk</span>
sudo ./Plx_load <span class="m">9054</span>

<span class="c1"># You Will see a prompt to load successfully</span>
<span class="nb">exit</span>  <span class="c1">#Exit ROOT permission  退出ROOT权限</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Start the graphical interface program</span>

<span class="nb">cd</span> ~
<span class="nb">cd</span> ~/PKUXIADAQ/GUI
./pku

<span class="c1"># The graphical interface will pop up.</span>
<span class="c1"># You can choose Online/Offline Mode then press Boot to initialize.</span>
<span class="c1"># After waiting for initialization, you can modify the output data file path, file name, and run number. Press the Complete button to confirm.</span>
<span class="c1"># The LSRunStart button becomes operational at this time. You can start pressing Start and then press Stop for the second time.</span>
<span class="c1"># Online Statistics option selections mean sending online statistics</span>
<span class="c1"># Update Energy Monitor: Each time you select it, the energy spectrum information is read from the plug-in and sent to the online program (frequent select</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Start the non-graphical interface program</span>

<span class="nb">cd</span> ~
<span class="nb">cd</span> ~/PKUXIADAQ/NOGUI
./pku
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## Start online monitor program</span>


<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/OnlineStattics/
./online

<span class="c1"># The graphical interface will pop up.</span>
<span class="c1"># Press RunStart to start monitoring and update the input rate and output rate of each channel every 3 seconds. (The first time you enable the program after opening the chassis, you need to enable it after the acquisition is turned on)</span>
<span class="c1"># In the lower right corner of the monitoring interface, there is monitoring of the amount of hard disk usage for writing data.</span>



<span class="c1"># EnergyMonitor page is used to view the spectrum. Due to the internal register size limitations of the plug-in, this energy spectrum differs from the actual spectrum in channel range.</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## execute data converter program</span>


<span class="nb">cd</span> ~
<span class="nb">cd</span> PKUXIADAQ/Decode/

<span class="c1"># After the last run of acquisition, we can convert the previous run of data to ROOT file.</span>

./decode xxx
<span class="c1">#xxx indicates Run Number</span>
</pre></div>
</div>
</section>
<section id="common-installation-errors">
<h2>Common installation errors<a class="headerlink" href="#common-installation-errors" title="永久链接至标题">¶</a></h2>
<p>For CentOS / scientific Linux 7.6 / 7.7, the wrong solution for installing PLX9054 driver:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./builddriver <span class="m">9054</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Build: Plx9054

- PLA: CentOS Linux release <span class="m">7</span>.6.1810 <span class="o">(</span>Core<span class="o">)</span>
- KER: <span class="m">3</span>.10.0-957.12.2.el7.x86_64
- INC: /lib/modules/3.10.0-957.12.2.el7.x86_64/build/include
- CPU: x86_64 <span class="o">(</span><span class="m">64</span>-bit Little Endian<span class="o">)</span>
- CMP: Gcc
- TYP: Driver
- PLX: <span class="m">9054</span>
- CFG: Release

make<span class="o">[</span><span class="m">1</span><span class="o">]</span>: Entering directory <span class="s1">&#39;/usr/src/kernels/3.10.0-957.12.2.el7.x86_64&#39;</span>
arch/x86/Makefile:166: *** <span class="nv">CONFIG_RETPOLINE</span><span class="o">=</span>y, but not supported by the compiler. Compiler update recommended.。 Stop.
make<span class="o">[</span><span class="m">1</span><span class="o">]</span>: Leaving directory <span class="s1">&#39;/usr/src/kernels/3.10.0-957.12.2.el7.x86_64&#39;</span>
make: *** <span class="o">[</span>BuildDriver<span class="o">]</span> Error <span class="m">2</span>
</pre></div>
</div>
<p>The above is the output prompt when the error occurs.</p>
<p>At this point, the user can modify the file <strong>/usr/src/kernels/3.10.0-957.12.2.el7.x86_64/arch/x86/Makefile</strong> to avoid this error by cancel the following code.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifneq <span class="o">(</span><span class="k">$(</span>RETPOLINE_CFLAGS<span class="k">)</span>,<span class="o">)</span>
    <span class="nv">KBUILD_CFLAGS</span> <span class="o">+=</span> <span class="k">$(</span>RETPOLINE_CFLAGS<span class="k">)</span> -DRETPOLINE
<span class="k">else</span>
    <span class="k">$(</span>error <span class="nv">CONFIG_RETPOLINE</span><span class="o">=</span>y, but not supported by the compiler. Compiler update recommended.<span class="k">)</span>
endif
</pre></div>
</div>
</section>
<section id="teamviewer">
<h2>TeamViewer<a class="headerlink" href="#teamviewer" title="永久链接至标题">¶</a></h2>
<p>TeamViewer is an app that allows you to remotely connect to multiple workstations. There are many apps that allow remote control of different systems, but TeamViewer is set up to be extremely accessible, while also being powerful.</p>
<p><a class="reference external" href="https://www.teamviewer.cn/cn/download/linux/">https://www.teamviewer.cn/cn/download/linux/</a></p>
<img alt="_images/TeamViewer.png" src="_images/TeamViewer.png" />
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="MYSQL.html" class="btn btn-neutral float-right" title="MYSQL" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="README.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; 版权所有 2020, Hongyi Wu(吴鸿毅).

    </p>
  </div>
    
    
    
    利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    
    由 <a href="https://readthedocs.org">Read the Docs</a>开发. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>